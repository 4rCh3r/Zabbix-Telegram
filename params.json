{"name":"Zabbix in Telegram","tagline":"Zabbix Notifications with graphs in Telegram","body":"# Zabbix-in-Telegram\r\nZabbix Notifications with graphs in Telegram\r\n\r\nJoin us in our **Telegram group** via this link: https://telegram.me/joinchat/AGnFigJ_NW75IGNnpOyjig\r\n\r\nRate on [share.zabbix.com](https://share.zabbix.com): https://share.zabbix.com/cat-notifications/zabbix-in-telegram\r\n\r\n### Features\r\n- [x] Graphs based on latest data are sent directly to your messenger\r\n- [x] You can send them both in private and group chats\r\n- [x] Saves chatid as a temporary file\r\n\r\n### Configuration / Installation\r\n\r\n**First of all**: You need to install the `requests` module for python, this is required for operation! </br>\r\n                  To do so, enter `pip install requests` in your commandline!\r\n\r\n * Put `zbxtg.py` in your `AlertScriptsPath` directory, the path is set inside your zabbix_server.conf\r\n * Put `zbxtg_group.py` in the same location if you want to send messages to the group chat\r\n * Create `zbxtg_settings.py` with your settings and save them in the same directory as the script, see example for layout\r\n  * Create a bot in Telegram and get API key\r\n  * Create readonly user in Zabbix (for getting graphs images from zabbix)\r\n  * Set proxy host:port in `zbxtg_settings.py` if you need an internet proxy\r\n * Add new media for Telegram in Zabbix web interface with these settings:\r\n \r\n<img src=\"https://i.imgur.com/Ytrbe4S.png\" width=\"400px\">\r\n\r\n * Add another one if you want to send messages to the group\r\n \r\n<img src=\"http://i.imgur.com/OTq4aQd.png\" width=\"400px\">\r\n \r\n * Send a message to your bot via Telegram, e.g. \"/start\"\r\n  * If you are in group chat, just mention your bot, e.g. `@ZbxTgDevBot ping`\r\n * Create a new action like this:\r\n```\r\nLast value: {ITEM.LASTVALUE1} ({TIME})\r\nzbxtg;graphs\r\nzbxtg;graphs_period=10800\r\nzbxtg;itemid:{ITEM.ID1}\r\nzbxtg;title:{HOST.HOST} - {TRIGGER.NAME}\r\n```\r\n\r\n<img src=\"https://i.imgur.com/ZNKtBUX.png\" width=\"400px\">\r\n\r\n * Add the appropriate Media Type to your user\r\n  * The username is **CASE-SENSITIVE**\r\n  * Group chats don't have URLs, so you need to put group's name in media type\r\n\r\n  * Private:\r\n\r\n  <img src=\"https://i.imgur.com/GVDlTU5.png\" width=\"400px\">\r\n\r\n  * Group:\r\n\r\n  <img src=\"https://i.imgur.com/TgcCqDf.png\" width=\"400px\">\r\n\r\n#### Annotations\r\n```\r\nzbxtg;graphs -- enables attached graphs\r\nzbxth;chat -- enables sending to group chats (default - set to 1-1 private chat)\r\nzbxtg;graphs_period=10800 -- set graphs period (default - 3600 seconds)\r\nzbxtg;graphs_width=700 -- set graphs width (default - 900px)\r\nzbxtg;graphs_height=300 -- set graphs height (default - 300px)\r\nzbxtg;itemid:{ITEM.ID1} -- define itemid (from trigger) for attach\r\nzbxtg;title:{HOST.HOST} - {TRIGGER.NAME} -- graph title\r\nzbxtg;debug -- enable debug mode, some logs and images will be saved in the tmp dir (temporary doesn't affect python version)\r\n```\r\n\r\nYou can use markdown in your action: https://core.telegram.org/bots/api#using-markdown\r\n\r\n#### Debug\r\n\r\n* You can use the following command to send a message from your command line: </br>\r\n`./zbxtg.py \"<username>\" \"<message_subject>\" \"<message_body>\"`\r\n * For `<username>` substitute your Telegram username, NOT that of your bot (case-sensitive)\r\n * For `<message_subject>` and `<message_body>` just substitute something like \"test\" \"test\" (for Telegram it's doesn't matter between subject and body\r\n * You can omit the `\"`, these are optional\r\n\r\n---\r\n\r\n![](http://i.imgur.com/1T4aHuf.png)\r\n![](http://i.imgur.com/5ZPyvoe.png)\r\n\r\n### Known issues\r\n\r\n#### MEDIA_CAPTION_TOO_LONG\r\nIf you see this error, it means that you rich the limit of caption with 200 symbols in it (Telegram API's limitaion).\r\nSuch captions will be automatically cut to 200 symbols.\r\n\r\n-\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}